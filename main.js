let videoCategories = [
  {
    categoryName: `Dr Seuss`,
    videos: [
      {
        title: `What Pet Should I Get`,
        url: `https://www.youtube.com/embed/psCzO1TlJlU?si=TWN5nX6YoFe72IUU`,
        description: {
          storyTitle: `What Pet Should I Get?`,
          author: `Dr. Seuss`,
          publisher: `Random House`,
          pageNumber: `48`,
          introduction: `A brother and sister visit a pet store to choose a pet, learning about decision-making and the joy of pets.`,
          moralValue: `Making choices can be hard, but it's important to decide and cherish the responsibilities and happiness our decisions bring.`
        }
      },
      {
        title: `Fox in Socks`,
        url: `https://www.youtube.com/embed/c-jB21cm2mo?si=Mh0W9KsKncyaQH-c`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      }
    ]
  },
  {
    categoryName: `Elephant and Piggie`,
    videos: [
      {
        title: `My New Friend Is So Fun`,
        url: `https://www.youtube.com/embed/-LLsAsXHYZw?si=DFeXD6dg_YTly8Fy`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `I Broke My Trunk`,
        url: `https://www.youtube.com/embed/TIOuDdeiJ9E?si=xsumBmwfUn5Zor57`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Waiting Is Not Easy`,
        url: `https://www.youtube.com/embed/PPswJFlmQp0?si=RJsQOBH_hizCLhp0`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      }
    ]
  },
  {
    categoryName: `Llama Llama`,
    videos: [
      {
        title: `Llama Llama Red Pajama`,
        url: `https://www.youtube.com/embed/K7evZs9iRoU?si=6xsQ69nXSyOBMrRZ`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Llama Llama Home With Mama`,
        url: `https://www.youtube.com/embed/2Ib6i1AL3IM?si=SWUJs4vAKPcvQiVL`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Llama Llama Time To Share`,
        url: `https://www.youtube.com/embed/ZpxTIOtd2d4?si=Wt1u1hraUzpEhrQa`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
    ]
  },
  {
    categoryName: `No, David!`,
    videos: [
      {
        title: `Grow Up, David!`,
        url: `https://www.youtube.com/embed/LrqLi8Aca2A?si=k_MbfK6l-0XZNjOX`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `David Gets in Trouble`,
        url: `https://www.youtube.com/embed/_7PYi7ihIpE?si=yRGWVa_wRLZqwqed`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `No, David!`,
        url: `https://www.youtube.com/embed/pIvm_8u0U1I?si=fvWSOdScoj_p1ACl`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
    ]
  },
  {
    categoryName: `Pete the Cat`,
    videos: [
      {
        title: `Pete the Cat and the Perfect Pizza Party`,
        url: `https://www.youtube.com/embed/yrVrFBGi43w?si=XrJsNYLEoCoU36hz`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat and the Bad Banana`,
        url: `https://www.youtube.com/embed/KQKiwFGCywA?si=TiYDZyl-qZ35rS-X`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat and His Four Groovy Buttons`,
        url: `https://www.youtube.com/embed/jouIlj6xp1M?si=C6FNGhERiRZHnLDf`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: Scuba-Cat`,
        url: `https://www.youtube.com/embed/vf_Yg_5J6T4?si=oom5URliIKgAhqAQ`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: I Love My White Shoes`,
        url: `https://www.youtube.com/embed/fj_z6zGQVyM?si=HZal3OqoDGeI4hVg`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: Super Pete`,
        url: `https://www.youtube.com/embed/t9nIlLxxBxw?si=LvMbhXD_h76AICMv`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: Robo-Pete`,
        url: `https://www.youtube.com/embed/ltuuKMpsQbs?si=usKZwvPNAxD_LOpS`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat Snow Daze`,
        url: `https://www.youtube.com/embed/WQ92ehmuxjs?si=njXca8zKPCCPPiqS`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: Big Easter Adventure`,
        url: `https://www.youtube.com/embed/ubTNaQsy8Fg?si=AYH0CsEgqMQGfsOJ`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat and the Itsy Bitsy Spider`,
        url: `https://www.youtube.com/embed/daxyn4uW-WI?si=jNF1KP1d03R8tWKw`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat: Five Little Pumpkins`,
        url: `https://www.youtube.com/embed/ZGnXklGW3_8?si=BEMLs0mmZHS3zmhE`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat's 12 Groovy Days of Christmas`,
        url: `https://www.youtube.com/embed/KJZtBoxZTh0?si=kZwgbr_mFzo2XIMc`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat and the Tip Top Tree House`,
        url: `https://www.youtube.com/embed/W-Fax35tKKI?si=aUX1Z3N9ZVmc5u00`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      },
      {
        title: `Pete the Cat and the Treasure Map`,
        url: `https://www.youtube.com/embed/rMF8WwKlGHw?si=dl9aDKnMDPKeMbji`,
        description: {
          storyTitle: `title here`,
          author: `author here`,
          publisher: `publisher here`,
          pageNumber: `page number here`,
          introduction: `introduction here`,
          moralValue: `moral value here`
        }
      }
    ]
  }
];

let filteredCategories = []; // Variable to hold filtered categories

const categoryList = document.querySelector(`.category-list`);
const bookPagesContainer = document.querySelector(`.book-pages`);
const bookContent = document.querySelector(`.book-content`);

// Function to load video based on category index and video index
function loadVideo(categoryIndex, videoIndex) {
  let categories = filteredCategories.length > 0 ? filteredCategories : videoCategories;

  if (!categories[categoryIndex]) {
    console.error(`Category at index ${categoryIndex} not found.`);
    return;
  }

  const category = categories[categoryIndex];
  const videos = category.videos;

  if (!videos || videoIndex < 0 || videoIndex >= videos.length) {
    console.error(`Video at index ${videoIndex} not found in category ${categoryIndex}.`);
    return;
  }

  const selectedVideo = videos[videoIndex];

  // Clear existing pages
  bookPagesContainer.innerHTML = ``;

  // Create iframe for video
  const iframe = document.createElement(`iframe`);
  iframe.src = selectedVideo.url;
  iframe.title = `Video player`;
  iframe.allow = `accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture`;
  iframe.referrerpolicy = `strict-origin-when-cross-origin`;
  iframe.allowFullscreen = true;
  iframe.style.width = `100%`; // Set iframe width to 100% of its container
  iframe.style.height = `100%`; // Set iframe height to 100% of its container

  // Append iframe to book pages container
  const page = document.createElement(`div`);
  page.classList.add(`book-page`);
  page.appendChild(iframe);
  bookPagesContainer.appendChild(page);

  // Update description section
  const descriptionSection = document.querySelector(`.description`);
  descriptionSection.innerHTML = `
    <h3>${selectedVideo.description.storyTitle}</h3>
    <p><strong>Author:</strong> ${selectedVideo.description.author}</p>
    <p><strong>Publisher:</strong> ${selectedVideo.description.publisher}</p>
    <p><strong>Page Number:</strong> ${selectedVideo.description.pageNumber}</p>
    <p><strong>Introduction:</strong> ${selectedVideo.description.introduction}</p>
    <p><strong>Moral Value:</strong> ${selectedVideo.description.moralValue}</p>
  `;
}

// Function to filter videos based on search query
function filterVideos(query) {
  query = query.toLowerCase();

  if (query.trim() === ``) {
    filteredCategories = [];
    renderCategories(videoCategories);
    collapseAllCategories();
    return;
  }

  filteredCategories = videoCategories.map(category => {
    const filteredVideos = category.videos.filter(video =>
      video.title.toLowerCase().includes(query)
    );
    if (filteredVideos.length > 0) {
      return { ...category, videos: filteredVideos };
    } else {
      return null;
    }
  }).filter(Boolean);

  renderCategories(filteredCategories);
  expandAllCategories();
}

// Function to collapse all category headers
function collapseAllCategories() {
  const categoryHeaders = document.querySelectorAll(`.category-header`);
  categoryHeaders.forEach(header => {
    header.classList.remove(`show`);
    const targetId = header.getAttribute(`data-target`);
    const targetCollapse = document.querySelector(targetId);
    if (targetCollapse) {
      targetCollapse.classList.remove(`show`);
    }
  });
}

// Function to expand all category headers
function expandAllCategories() {
  const categoryHeaders = document.querySelectorAll(`.category-header`);
  categoryHeaders.forEach(header => {
    header.classList.add(`show`);
    const targetId = header.getAttribute(`data-target`);
    const targetCollapse = document.querySelector(targetId);
    if (targetCollapse) {
      targetCollapse.classList.add(`show`);
    }
  });
}

function renderCategories(categories) {
  categoryList.innerHTML = ``;

  categories.forEach((category, index) => {
    const categoryItem = document.createElement(`li`);
    categoryItem.classList.add(`category`);

    const categoryHeader = document.createElement(`div`);
    categoryHeader.classList.add(`category-header`);
    categoryHeader.textContent = category.categoryName;
    categoryHeader.setAttribute(`data-toggle`, `collapse`);
    categoryHeader.setAttribute(`data-target`, `#category-${index}`);

    const videoList = document.createElement(`ul`);
    videoList.classList.add(`video-list`, `collapse`);
    videoList.id = `category-${index}`;

    category.videos.forEach((video, videoIndex) => {
      const videoItem = document.createElement(`li`);
      videoItem.classList.add(`video`);

      let iconClass;
      if (video.url.includes(`youtube.com`)) {
        iconClass = `fab fa-youtube youtube`;
      } else if (video.url.includes(`facebook.com`)) {
        iconClass = `fab fa-facebook facebook`;
      } else {
        iconClass = `fas fa-video other`;
      }

      const icon = document.createElement(`i`);
      icon.className = iconClass;

      videoItem.appendChild(icon);
      videoItem.appendChild(document.createTextNode(video.title));

      videoItem.addEventListener(`click`, () => {
        switchCategory(index, videoIndex);
      });
      videoList.appendChild(videoItem);
    });

    categoryItem.appendChild(categoryHeader);
    categoryItem.appendChild(videoList);
    categoryList.appendChild(categoryItem);
  });
}

function switchCategory(categoryIndex, videoIndex = 0) {
  loadVideo(categoryIndex, videoIndex);
}

// Populate categories and videos in the directory
videoCategories.forEach((category, index) => {
  const categoryItem = document.createElement(`li`);
  categoryItem.classList.add(`category`);

  const categoryHeader = document.createElement(`div`);
  categoryHeader.classList.add(`category-header`);
  categoryHeader.textContent = category.categoryName;
  categoryHeader.setAttribute(`data-toggle`, `collapse`);
  categoryHeader.setAttribute(`data-target`, `#category-${index}`);

  const videoList = document.createElement(`ul`);
  videoList.classList.add(`video-list`, `collapse`);
  videoList.id = `category-${index}`;

  category.videos.forEach((video, videoIndex) => {
    const videoItem = document.createElement(`li`);
    videoItem.classList.add(`video`);

    let iconClass;
    if (video.url.includes(`youtube.com`)) {
      iconClass = `fab fa-youtube youtube`;
    } else if (video.url.includes(`facebook.com`)) {
      iconClass = `fab fa-facebook facebook`;
    } else {
      iconClass = `fas fa-video other`;
    }

    const icon = document.createElement(`i`);
    icon.className = iconClass;

    videoItem.appendChild(icon);
    videoItem.appendChild(document.createTextNode(video.title));

    videoItem.addEventListener(`click`, () => {
      switchCategory(index, videoIndex);
    });
    videoList.appendChild(videoItem);
  });

  categoryItem.appendChild(categoryHeader);
  categoryItem.appendChild(videoList);
  categoryList.appendChild(categoryItem);
});

const videoSearchInput = document.getElementById(`videoSearch`);
videoSearchInput.addEventListener(`input`, function () {
  const searchText = this.value.trim();
  filterVideos(searchText);
});

// Update current year in footer
const currentYear = new Date().getFullYear();
document.getElementById(`copyright-year`).textContent = currentYear;

